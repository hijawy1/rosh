var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,s=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,a=(e,t)=>{for(var n in t||(t={}))o.call(t,n)&&s(e,n,t[n]);if(r)for(var n of r(t))i.call(t,n)&&s(e,n,t[n]);return e},c=(e,r)=>t(e,n(r));import{c as l}from"./_commonjsHelpers.0592d25c.js";var u=function(){function e(e,t,n){this.eventTarget=e,this.eventName=t,this.eventOptions=n,this.unorderedBindings=new Set}return e.prototype.connect=function(){this.eventTarget.addEventListener(this.eventName,this,this.eventOptions)},e.prototype.disconnect=function(){this.eventTarget.removeEventListener(this.eventName,this,this.eventOptions)},e.prototype.bindingConnected=function(e){this.unorderedBindings.add(e)},e.prototype.bindingDisconnected=function(e){this.unorderedBindings.delete(e)},e.prototype.handleEvent=function(e){for(var t=function(e){if("immediatePropagationStopped"in e)return e;var t=e.stopImmediatePropagation;return Object.assign(e,{immediatePropagationStopped:!1,stopImmediatePropagation:function(){this.immediatePropagationStopped=!0,t.call(this)}})}(e),n=0,r=this.bindings;n<r.length;n++){var o=r[n];if(t.immediatePropagationStopped)break;o.handleEvent(t)}},Object.defineProperty(e.prototype,"bindings",{get:function(){return Array.from(this.unorderedBindings).sort((function(e,t){var n=e.index,r=t.index;return n<r?-1:n>r?1:0}))},enumerable:!1,configurable:!0}),e}();var d=function(){function e(e){this.application=e,this.eventListenerMaps=new Map,this.started=!1}return e.prototype.start=function(){this.started||(this.started=!0,this.eventListeners.forEach((function(e){return e.connect()})))},e.prototype.stop=function(){this.started&&(this.started=!1,this.eventListeners.forEach((function(e){return e.disconnect()})))},Object.defineProperty(e.prototype,"eventListeners",{get:function(){return Array.from(this.eventListenerMaps.values()).reduce((function(e,t){return e.concat(Array.from(t.values()))}),[])},enumerable:!1,configurable:!0}),e.prototype.bindingConnected=function(e){this.fetchEventListenerForBinding(e).bindingConnected(e)},e.prototype.bindingDisconnected=function(e){this.fetchEventListenerForBinding(e).bindingDisconnected(e)},e.prototype.handleError=function(e,t,n){void 0===n&&(n={}),this.application.handleError(e,"Error "+t,n)},e.prototype.fetchEventListenerForBinding=function(e){var t=e.eventTarget,n=e.eventName,r=e.eventOptions;return this.fetchEventListener(t,n,r)},e.prototype.fetchEventListener=function(e,t,n){var r=this.fetchEventListenerMapForEventTarget(e),o=this.cacheKey(t,n),i=r.get(o);return i||(i=this.createEventListener(e,t,n),r.set(o,i)),i},e.prototype.createEventListener=function(e,t,n){var r=new u(e,t,n);return this.started&&r.connect(),r},e.prototype.fetchEventListenerMapForEventTarget=function(e){var t=this.eventListenerMaps.get(e);return t||(t=new Map,this.eventListenerMaps.set(e,t)),t},e.prototype.cacheKey=function(e,t){var n=[e];return Object.keys(t).sort().forEach((function(e){n.push((t[e]?"":"!")+e)})),n.join(":")},e}(),p=/^((.+?)(@(window|document))?->)?(.+?)(#([^:]+?))(:(.+))?$/;function f(e){return"window"==e?window:"document"==e?document:void 0}var h=function(){function e(e,t,n){this.element=e,this.index=t,this.eventTarget=n.eventTarget||e,this.eventName=n.eventName||function(e){var t=e.tagName.toLowerCase();if(t in m)return m[t](e)}(e)||g("missing event name"),this.eventOptions=n.eventOptions||{},this.identifier=n.identifier||g("missing identifier"),this.methodName=n.methodName||g("missing method name")}return e.forToken=function(e){return new this(e.element,e.index,(t=e.content,{eventTarget:f((r=t.trim().match(p)||[])[4]),eventName:r[2],eventOptions:r[9]?(n=r[9],n.split(":").reduce((function(e,t){var n;return Object.assign(e,((n={})[t.replace(/^!/,"")]=!/^!/.test(t),n))}),{})):{},identifier:r[5],methodName:r[7]}));var t,n,r},e.prototype.toString=function(){var e=this.eventTargetName?"@"+this.eventTargetName:"";return""+this.eventName+e+"->"+this.identifier+"#"+this.methodName},Object.defineProperty(e.prototype,"eventTargetName",{get:function(){return(e=this.eventTarget)==window?"window":e==document?"document":void 0;var e},enumerable:!1,configurable:!0}),e}(),m={a:function(e){return"click"},button:function(e){return"click"},form:function(e){return"submit"},input:function(e){return"submit"==e.getAttribute("type")?"click":"input"},select:function(e){return"change"},textarea:function(e){return"input"}};function g(e){throw new Error(e)}var b=function(){function e(e,t){this.context=e,this.action=t}return Object.defineProperty(e.prototype,"index",{get:function(){return this.action.index},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"eventTarget",{get:function(){return this.action.eventTarget},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"eventOptions",{get:function(){return this.action.eventOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"identifier",{get:function(){return this.context.identifier},enumerable:!1,configurable:!0}),e.prototype.handleEvent=function(e){this.willBeInvokedByEvent(e)&&this.invokeWithEvent(e)},Object.defineProperty(e.prototype,"eventName",{get:function(){return this.action.eventName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"method",{get:function(){var e=this.controller[this.methodName];if("function"==typeof e)return e;throw new Error('Action "'+this.action+'" references undefined method "'+this.methodName+'"')},enumerable:!1,configurable:!0}),e.prototype.invokeWithEvent=function(e){try{this.method.call(this.controller,e)}catch(r){var t=this,n={identifier:t.identifier,controller:t.controller,element:t.element,index:t.index,event:e};this.context.handleError(r,'invoking action "'+this.action+'"',n)}},e.prototype.willBeInvokedByEvent=function(e){var t=e.target;return this.element===t||(t instanceof Element&&this.element.contains(t)?this.scope.containsElement(t):this.scope.containsElement(this.action.element))},Object.defineProperty(e.prototype,"controller",{get:function(){return this.context.controller},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"methodName",{get:function(){return this.action.methodName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this.scope.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scope",{get:function(){return this.context.scope},enumerable:!1,configurable:!0}),e}(),y=function(){function e(e,t){var n=this;this.element=e,this.started=!1,this.delegate=t,this.elements=new Set,this.mutationObserver=new MutationObserver((function(e){return n.processMutations(e)}))}return e.prototype.start=function(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0,childList:!0,subtree:!0}),this.refresh())},e.prototype.stop=function(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)},e.prototype.refresh=function(){if(this.started){for(var e=new Set(this.matchElementsInTree()),t=0,n=Array.from(this.elements);t<n.length;t++){var r=n[t];e.has(r)||this.removeElement(r)}for(var o=0,i=Array.from(e);o<i.length;o++){r=i[o];this.addElement(r)}}},e.prototype.processMutations=function(e){if(this.started)for(var t=0,n=e;t<n.length;t++){var r=n[t];this.processMutation(r)}},e.prototype.processMutation=function(e){"attributes"==e.type?this.processAttributeChange(e.target,e.attributeName):"childList"==e.type&&(this.processRemovedNodes(e.removedNodes),this.processAddedNodes(e.addedNodes))},e.prototype.processAttributeChange=function(e,t){var n=e;this.elements.has(n)?this.delegate.elementAttributeChanged&&this.matchElement(n)?this.delegate.elementAttributeChanged(n,t):this.removeElement(n):this.matchElement(n)&&this.addElement(n)},e.prototype.processRemovedNodes=function(e){for(var t=0,n=Array.from(e);t<n.length;t++){var r=n[t],o=this.elementFromNode(r);o&&this.processTree(o,this.removeElement)}},e.prototype.processAddedNodes=function(e){for(var t=0,n=Array.from(e);t<n.length;t++){var r=n[t],o=this.elementFromNode(r);o&&this.elementIsActive(o)&&this.processTree(o,this.addElement)}},e.prototype.matchElement=function(e){return this.delegate.matchElement(e)},e.prototype.matchElementsInTree=function(e){return void 0===e&&(e=this.element),this.delegate.matchElementsInTree(e)},e.prototype.processTree=function(e,t){for(var n=0,r=this.matchElementsInTree(e);n<r.length;n++){var o=r[n];t.call(this,o)}},e.prototype.elementFromNode=function(e){if(e.nodeType==Node.ELEMENT_NODE)return e},e.prototype.elementIsActive=function(e){return e.isConnected==this.element.isConnected&&this.element.contains(e)},e.prototype.addElement=function(e){this.elements.has(e)||this.elementIsActive(e)&&(this.elements.add(e),this.delegate.elementMatched&&this.delegate.elementMatched(e))},e.prototype.removeElement=function(e){this.elements.has(e)&&(this.elements.delete(e),this.delegate.elementUnmatched&&this.delegate.elementUnmatched(e))},e}(),v=function(){function e(e,t,n){this.attributeName=t,this.delegate=n,this.elementObserver=new y(e,this)}return Object.defineProperty(e.prototype,"element",{get:function(){return this.elementObserver.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selector",{get:function(){return"["+this.attributeName+"]"},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.elementObserver.start()},e.prototype.stop=function(){this.elementObserver.stop()},e.prototype.refresh=function(){this.elementObserver.refresh()},Object.defineProperty(e.prototype,"started",{get:function(){return this.elementObserver.started},enumerable:!1,configurable:!0}),e.prototype.matchElement=function(e){return e.hasAttribute(this.attributeName)},e.prototype.matchElementsInTree=function(e){var t=this.matchElement(e)?[e]:[],n=Array.from(e.querySelectorAll(this.selector));return t.concat(n)},e.prototype.elementMatched=function(e){this.delegate.elementMatchedAttribute&&this.delegate.elementMatchedAttribute(e,this.attributeName)},e.prototype.elementUnmatched=function(e){this.delegate.elementUnmatchedAttribute&&this.delegate.elementUnmatchedAttribute(e,this.attributeName)},e.prototype.elementAttributeChanged=function(e,t){this.delegate.elementAttributeValueChanged&&this.attributeName==t&&this.delegate.elementAttributeValueChanged(e,t)},e}(),w=function(){function e(e,t){var n=this;this.element=e,this.delegate=t,this.started=!1,this.stringMap=new Map,this.mutationObserver=new MutationObserver((function(e){return n.processMutations(e)}))}return e.prototype.start=function(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0}),this.refresh())},e.prototype.stop=function(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)},e.prototype.refresh=function(){if(this.started)for(var e=0,t=this.knownAttributeNames;e<t.length;e++){var n=t[e];this.refreshAttribute(n)}},e.prototype.processMutations=function(e){if(this.started)for(var t=0,n=e;t<n.length;t++){var r=n[t];this.processMutation(r)}},e.prototype.processMutation=function(e){var t=e.attributeName;t&&this.refreshAttribute(t)},e.prototype.refreshAttribute=function(e){var t=this.delegate.getStringMapKeyForAttribute(e);if(null!=t){this.stringMap.has(e)||this.stringMapKeyAdded(t,e);var n=this.element.getAttribute(e);this.stringMap.get(e)!=n&&this.stringMapValueChanged(n,t),null==n?(this.stringMap.delete(e),this.stringMapKeyRemoved(t,e)):this.stringMap.set(e,n)}},e.prototype.stringMapKeyAdded=function(e,t){this.delegate.stringMapKeyAdded&&this.delegate.stringMapKeyAdded(e,t)},e.prototype.stringMapValueChanged=function(e,t){this.delegate.stringMapValueChanged&&this.delegate.stringMapValueChanged(e,t)},e.prototype.stringMapKeyRemoved=function(e,t){this.delegate.stringMapKeyRemoved&&this.delegate.stringMapKeyRemoved(e,t)},Object.defineProperty(e.prototype,"knownAttributeNames",{get:function(){return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentAttributeNames",{get:function(){return Array.from(this.element.attributes).map((function(e){return e.name}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"recordedAttributeNames",{get:function(){return Array.from(this.stringMap.keys())},enumerable:!1,configurable:!0}),e}();function x(e,t,n){E(e,t).add(n)}function A(e,t,n){E(e,t).delete(n),function(e,t){var n=e.get(t);null!=n&&0==n.size&&e.delete(t)}(e,t)}function E(e,t){var n=e.get(t);return n||(n=new Set,e.set(t,n)),n}var O,S=function(){function e(){this.valuesByKey=new Map}return Object.defineProperty(e.prototype,"values",{get:function(){return Array.from(this.valuesByKey.values()).reduce((function(e,t){return e.concat(Array.from(t))}),[])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return Array.from(this.valuesByKey.values()).reduce((function(e,t){return e+t.size}),0)},enumerable:!1,configurable:!0}),e.prototype.add=function(e,t){x(this.valuesByKey,e,t)},e.prototype.delete=function(e,t){A(this.valuesByKey,e,t)},e.prototype.has=function(e,t){var n=this.valuesByKey.get(e);return null!=n&&n.has(t)},e.prototype.hasKey=function(e){return this.valuesByKey.has(e)},e.prototype.hasValue=function(e){return Array.from(this.valuesByKey.values()).some((function(t){return t.has(e)}))},e.prototype.getValuesForKey=function(e){var t=this.valuesByKey.get(e);return t?Array.from(t):[]},e.prototype.getKeysForValue=function(e){return Array.from(this.valuesByKey).filter((function(t){return t[0],t[1].has(e)})).map((function(e){var t=e[0];return e[1],t}))},e}(),C=globalThis&&globalThis.__extends||(O=function(e,t){return(O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}O(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});!function(e){function t(){var t=e.call(this)||this;return t.keysByValue=new Map,t}C(t,e),Object.defineProperty(t.prototype,"values",{get:function(){return Array.from(this.keysByValue.keys())},enumerable:!1,configurable:!0}),t.prototype.add=function(t,n){e.prototype.add.call(this,t,n),x(this.keysByValue,n,t)},t.prototype.delete=function(t,n){e.prototype.delete.call(this,t,n),A(this.keysByValue,n,t)},t.prototype.hasValue=function(e){return this.keysByValue.has(e)},t.prototype.getKeysForValue=function(e){var t=this.keysByValue.get(e);return t?Array.from(t):[]}}(S);var T=function(){function e(e,t,n){this.attributeObserver=new v(e,t,this),this.delegate=n,this.tokensByElement=new S}return Object.defineProperty(e.prototype,"started",{get:function(){return this.attributeObserver.started},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.attributeObserver.start()},e.prototype.stop=function(){this.attributeObserver.stop()},e.prototype.refresh=function(){this.attributeObserver.refresh()},Object.defineProperty(e.prototype,"element",{get:function(){return this.attributeObserver.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attributeName",{get:function(){return this.attributeObserver.attributeName},enumerable:!1,configurable:!0}),e.prototype.elementMatchedAttribute=function(e){this.tokensMatched(this.readTokensForElement(e))},e.prototype.elementAttributeValueChanged=function(e){var t=this.refreshTokensForElement(e),n=t[0],r=t[1];this.tokensUnmatched(n),this.tokensMatched(r)},e.prototype.elementUnmatchedAttribute=function(e){this.tokensUnmatched(this.tokensByElement.getValuesForKey(e))},e.prototype.tokensMatched=function(e){var t=this;e.forEach((function(e){return t.tokenMatched(e)}))},e.prototype.tokensUnmatched=function(e){var t=this;e.forEach((function(e){return t.tokenUnmatched(e)}))},e.prototype.tokenMatched=function(e){this.delegate.tokenMatched(e),this.tokensByElement.add(e.element,e)},e.prototype.tokenUnmatched=function(e){this.delegate.tokenUnmatched(e),this.tokensByElement.delete(e.element,e)},e.prototype.refreshTokensForElement=function(e){var t,n,r,o=this.tokensByElement.getValuesForKey(e),i=this.readTokensForElement(e),s=(t=o,n=i,r=Math.max(t.length,n.length),Array.from({length:r},(function(e,r){return[t[r],n[r]]}))).findIndex((function(e){return!function(e,t){return e&&t&&e.index==t.index&&e.content==t.content}(e[0],e[1])}));return-1==s?[[],[]]:[o.slice(s),i.slice(s)]},e.prototype.readTokensForElement=function(e){var t=this.attributeName;return function(e,t,n){return e.trim().split(/\s+/).filter((function(e){return e.length})).map((function(e,r){return{element:t,attributeName:n,content:e,index:r}}))}(e.getAttribute(t)||"",e,t)},e}();var k=function(){function e(e,t,n){this.tokenListObserver=new T(e,t,this),this.delegate=n,this.parseResultsByToken=new WeakMap,this.valuesByTokenByElement=new WeakMap}return Object.defineProperty(e.prototype,"started",{get:function(){return this.tokenListObserver.started},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.tokenListObserver.start()},e.prototype.stop=function(){this.tokenListObserver.stop()},e.prototype.refresh=function(){this.tokenListObserver.refresh()},Object.defineProperty(e.prototype,"element",{get:function(){return this.tokenListObserver.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attributeName",{get:function(){return this.tokenListObserver.attributeName},enumerable:!1,configurable:!0}),e.prototype.tokenMatched=function(e){var t=e.element,n=this.fetchParseResultForToken(e).value;n&&(this.fetchValuesByTokenForElement(t).set(e,n),this.delegate.elementMatchedValue(t,n))},e.prototype.tokenUnmatched=function(e){var t=e.element,n=this.fetchParseResultForToken(e).value;n&&(this.fetchValuesByTokenForElement(t).delete(e),this.delegate.elementUnmatchedValue(t,n))},e.prototype.fetchParseResultForToken=function(e){var t=this.parseResultsByToken.get(e);return t||(t=this.parseToken(e),this.parseResultsByToken.set(e,t)),t},e.prototype.fetchValuesByTokenForElement=function(e){var t=this.valuesByTokenByElement.get(e);return t||(t=new Map,this.valuesByTokenByElement.set(e,t)),t},e.prototype.parseToken=function(e){try{return{value:this.delegate.parseValueForToken(e)}}catch(t){return{error:t}}},e}(),j=function(){function e(e,t){this.context=e,this.delegate=t,this.bindingsByAction=new Map}return e.prototype.start=function(){this.valueListObserver||(this.valueListObserver=new k(this.element,this.actionAttribute,this),this.valueListObserver.start())},e.prototype.stop=function(){this.valueListObserver&&(this.valueListObserver.stop(),delete this.valueListObserver,this.disconnectAllActions())},Object.defineProperty(e.prototype,"element",{get:function(){return this.context.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"identifier",{get:function(){return this.context.identifier},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actionAttribute",{get:function(){return this.schema.actionAttribute},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"schema",{get:function(){return this.context.schema},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bindings",{get:function(){return Array.from(this.bindingsByAction.values())},enumerable:!1,configurable:!0}),e.prototype.connectAction=function(e){var t=new b(this.context,e);this.bindingsByAction.set(e,t),this.delegate.bindingConnected(t)},e.prototype.disconnectAction=function(e){var t=this.bindingsByAction.get(e);t&&(this.bindingsByAction.delete(e),this.delegate.bindingDisconnected(t))},e.prototype.disconnectAllActions=function(){var e=this;this.bindings.forEach((function(t){return e.delegate.bindingDisconnected(t)})),this.bindingsByAction.clear()},e.prototype.parseValueForToken=function(e){var t=h.forToken(e);if(t.identifier==this.identifier)return t},e.prototype.elementMatchedValue=function(e,t){this.connectAction(t)},e.prototype.elementUnmatchedValue=function(e,t){this.disconnectAction(t)},e}(),N=function(){function e(e,t){this.context=e,this.receiver=t,this.stringMapObserver=new w(this.element,this),this.valueDescriptorMap=this.controller.valueDescriptorMap,this.invokeChangedCallbacksForDefaultValues()}return e.prototype.start=function(){this.stringMapObserver.start()},e.prototype.stop=function(){this.stringMapObserver.stop()},Object.defineProperty(e.prototype,"element",{get:function(){return this.context.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controller",{get:function(){return this.context.controller},enumerable:!1,configurable:!0}),e.prototype.getStringMapKeyForAttribute=function(e){if(e in this.valueDescriptorMap)return this.valueDescriptorMap[e].name},e.prototype.stringMapValueChanged=function(e,t){this.invokeChangedCallbackForValue(t)},e.prototype.invokeChangedCallbacksForDefaultValues=function(){for(var e=0,t=this.valueDescriptors;e<t.length;e++){var n=t[e],r=n.key,o=n.name;null==n.defaultValue||this.controller.data.has(r)||this.invokeChangedCallbackForValue(o)}},e.prototype.invokeChangedCallbackForValue=function(e){var t=e+"Changed",n=this.receiver[t];if("function"==typeof n){var r=this.receiver[e];n.call(this.receiver,r)}},Object.defineProperty(e.prototype,"valueDescriptors",{get:function(){var e=this.valueDescriptorMap;return Object.keys(e).map((function(t){return e[t]}))},enumerable:!1,configurable:!0}),e}(),P=function(){function e(e,t){this.module=e,this.scope=t,this.controller=new e.controllerConstructor(this),this.bindingObserver=new j(this,this.dispatcher),this.valueObserver=new N(this,this.controller);try{this.controller.initialize()}catch(n){this.handleError(n,"initializing controller")}}return e.prototype.connect=function(){this.bindingObserver.start(),this.valueObserver.start();try{this.controller.connect()}catch(e){this.handleError(e,"connecting controller")}},e.prototype.disconnect=function(){try{this.controller.disconnect()}catch(e){this.handleError(e,"disconnecting controller")}this.valueObserver.stop(),this.bindingObserver.stop()},Object.defineProperty(e.prototype,"application",{get:function(){return this.module.application},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"identifier",{get:function(){return this.module.identifier},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"schema",{get:function(){return this.application.schema},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dispatcher",{get:function(){return this.application.dispatcher},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this.scope.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return this.element.parentElement},enumerable:!1,configurable:!0}),e.prototype.handleError=function(e,t,n){void 0===n&&(n={});var r=this,o=r.identifier,i=r.controller,s=r.element;n=Object.assign({identifier:o,controller:i,element:s},n),this.application.handleError(e,"Error "+t,n)},e}();function _(e,t){var n=I(e);return Array.from(n.reduce((function(e,n){return function(e,t){var n=e[t];return Array.isArray(n)?n:[]}(n,t).forEach((function(t){return e.add(t)})),e}),new Set))}function M(e,t){return I(e).reduce((function(e,n){return e.push.apply(e,function(e,t){var n=e[t];return n?Object.keys(n).map((function(e){return[e,n[e]]})):[]}(n,t)),e}),[])}function I(e){for(var t=[];e;)t.push(e),e=Object.getPrototypeOf(e);return t.reverse()}var R=globalThis&&globalThis.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),L=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r};function D(e){return function(e,t){var n=F(e),r=function(e,t){return B(t).reduce((function(n,r){var o,i=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e,n);if(!r||!("value"in r)){var o=Object.getOwnPropertyDescriptor(t,n).value;return r&&(o.get=r.get||o.get,o.set=r.set||o.set),o}}(e,t,r);return i&&Object.assign(n,((o={})[r]=i,o)),n}),{})}(e.prototype,t);return Object.defineProperties(n.prototype,r),n}(e,function(e){return _(e,"blessings").reduce((function(t,n){var r=n(e);for(var o in r){var i=t[o]||{};t[o]=Object.assign(i,r[o])}return t}),{})}(e))}var B="function"==typeof Object.getOwnPropertySymbols?function(e){return L(Object.getOwnPropertyNames(e),Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,F=function(){function e(e){function t(){var n=this&&this instanceof t?this.constructor:void 0;return Reflect.construct(e,arguments,n)}return t.prototype=Object.create(e.prototype,{constructor:{value:t}}),Reflect.setPrototypeOf(t,e),t}try{return(t=e((function(){this.a.call(this)}))).prototype.a=function(){},new t,e}catch(n){return function(e){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R(t,e),t}(e)}}var t}();var $=function(){function e(e,t){this.application=e,this.definition=function(e){return{identifier:e.identifier,controllerConstructor:D(e.controllerConstructor)}}(t),this.contextsByScope=new WeakMap,this.connectedContexts=new Set}return Object.defineProperty(e.prototype,"identifier",{get:function(){return this.definition.identifier},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controllerConstructor",{get:function(){return this.definition.controllerConstructor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contexts",{get:function(){return Array.from(this.connectedContexts)},enumerable:!1,configurable:!0}),e.prototype.connectContextForScope=function(e){var t=this.fetchContextForScope(e);this.connectedContexts.add(t),t.connect()},e.prototype.disconnectContextForScope=function(e){var t=this.contextsByScope.get(e);t&&(this.connectedContexts.delete(t),t.disconnect())},e.prototype.fetchContextForScope=function(e){var t=this.contextsByScope.get(e);return t||(t=new P(this,e),this.contextsByScope.set(e,t)),t},e}(),V=function(){function e(e){this.scope=e}return e.prototype.has=function(e){return this.data.has(this.getDataKey(e))},e.prototype.get=function(e){return this.data.get(this.getDataKey(e))},e.prototype.getAttributeName=function(e){return this.data.getAttributeNameForKey(this.getDataKey(e))},e.prototype.getDataKey=function(e){return e+"-class"},Object.defineProperty(e.prototype,"data",{get:function(){return this.scope.data},enumerable:!1,configurable:!0}),e}();function U(e){return e.replace(/(?:[_-])([a-z0-9])/g,(function(e,t){return t.toUpperCase()}))}function z(e){return e.charAt(0).toUpperCase()+e.slice(1)}function q(e){return e.replace(/([A-Z])/g,(function(e,t){return"-"+t.toLowerCase()}))}var K=function(){function e(e){this.scope=e}return Object.defineProperty(e.prototype,"element",{get:function(){return this.scope.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"identifier",{get:function(){return this.scope.identifier},enumerable:!1,configurable:!0}),e.prototype.get=function(e){var t=this.getAttributeNameForKey(e);return this.element.getAttribute(t)},e.prototype.set=function(e,t){var n=this.getAttributeNameForKey(e);return this.element.setAttribute(n,t),this.get(e)},e.prototype.has=function(e){var t=this.getAttributeNameForKey(e);return this.element.hasAttribute(t)},e.prototype.delete=function(e){if(this.has(e)){var t=this.getAttributeNameForKey(e);return this.element.removeAttribute(t),!0}return!1},e.prototype.getAttributeNameForKey=function(e){return"data-"+this.identifier+"-"+q(e)},e}(),H=function(){function e(e){this.warnedKeysByObject=new WeakMap,this.logger=e}return e.prototype.warn=function(e,t,n){var r=this.warnedKeysByObject.get(e);r||(r=new Set,this.warnedKeysByObject.set(e,r)),r.has(t)||(r.add(t),this.logger.warn(n,e))},e}();function W(e,t){return"["+e+'~="'+t+'"]'}var Q=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r},X=function(){function e(e){this.scope=e}return Object.defineProperty(e.prototype,"element",{get:function(){return this.scope.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"identifier",{get:function(){return this.scope.identifier},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"schema",{get:function(){return this.scope.schema},enumerable:!1,configurable:!0}),e.prototype.has=function(e){return null!=this.find(e)},e.prototype.find=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce((function(t,n){return t||e.findTarget(n)||e.findLegacyTarget(n)}),void 0)},e.prototype.findAll=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce((function(t,n){return Q(t,e.findAllTargets(n),e.findAllLegacyTargets(n))}),[])},e.prototype.findTarget=function(e){var t=this.getSelectorForTargetName(e);return this.scope.findElement(t)},e.prototype.findAllTargets=function(e){var t=this.getSelectorForTargetName(e);return this.scope.findAllElements(t)},e.prototype.getSelectorForTargetName=function(e){return W("data-"+this.identifier+"-target",e)},e.prototype.findLegacyTarget=function(e){var t=this.getLegacySelectorForTargetName(e);return this.deprecate(this.scope.findElement(t),e)},e.prototype.findAllLegacyTargets=function(e){var t=this,n=this.getLegacySelectorForTargetName(e);return this.scope.findAllElements(n).map((function(n){return t.deprecate(n,e)}))},e.prototype.getLegacySelectorForTargetName=function(e){var t=this.identifier+"."+e;return W(this.schema.targetAttribute,t)},e.prototype.deprecate=function(e,t){if(e){var n=this.identifier,r=this.schema.targetAttribute;this.guide.warn(e,"target:"+t,"Please replace "+r+'="'+n+"."+t+'" with data-'+n+'-target="'+t+'". The '+r+" attribute is deprecated and will be removed in a future version of Stimulus.")}return e},Object.defineProperty(e.prototype,"guide",{get:function(){return this.scope.guide},enumerable:!1,configurable:!0}),e}(),J=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r},Y=function(){function e(e,t,n,r){var o=this;this.targets=new X(this),this.classes=new V(this),this.data=new K(this),this.containsElement=function(e){return e.closest(o.controllerSelector)===o.element},this.schema=e,this.element=t,this.identifier=n,this.guide=new H(r)}return e.prototype.findElement=function(e){return this.element.matches(e)?this.element:this.queryElements(e).find(this.containsElement)},e.prototype.findAllElements=function(e){return J(this.element.matches(e)?[this.element]:[],this.queryElements(e).filter(this.containsElement))},e.prototype.queryElements=function(e){return Array.from(this.element.querySelectorAll(e))},Object.defineProperty(e.prototype,"controllerSelector",{get:function(){return W(this.schema.controllerAttribute,this.identifier)},enumerable:!1,configurable:!0}),e}(),G=function(){function e(e,t,n){this.element=e,this.schema=t,this.delegate=n,this.valueListObserver=new k(this.element,this.controllerAttribute,this),this.scopesByIdentifierByElement=new WeakMap,this.scopeReferenceCounts=new WeakMap}return e.prototype.start=function(){this.valueListObserver.start()},e.prototype.stop=function(){this.valueListObserver.stop()},Object.defineProperty(e.prototype,"controllerAttribute",{get:function(){return this.schema.controllerAttribute},enumerable:!1,configurable:!0}),e.prototype.parseValueForToken=function(e){var t=e.element,n=e.content,r=this.fetchScopesByIdentifierForElement(t),o=r.get(n);return o||(o=this.delegate.createScopeForElementAndIdentifier(t,n),r.set(n,o)),o},e.prototype.elementMatchedValue=function(e,t){var n=(this.scopeReferenceCounts.get(t)||0)+1;this.scopeReferenceCounts.set(t,n),1==n&&this.delegate.scopeConnected(t)},e.prototype.elementUnmatchedValue=function(e,t){var n=this.scopeReferenceCounts.get(t);n&&(this.scopeReferenceCounts.set(t,n-1),1==n&&this.delegate.scopeDisconnected(t))},e.prototype.fetchScopesByIdentifierForElement=function(e){var t=this.scopesByIdentifierByElement.get(e);return t||(t=new Map,this.scopesByIdentifierByElement.set(e,t)),t},e}(),Z=function(){function e(e){this.application=e,this.scopeObserver=new G(this.element,this.schema,this),this.scopesByIdentifier=new S,this.modulesByIdentifier=new Map}return Object.defineProperty(e.prototype,"element",{get:function(){return this.application.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"schema",{get:function(){return this.application.schema},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logger",{get:function(){return this.application.logger},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controllerAttribute",{get:function(){return this.schema.controllerAttribute},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"modules",{get:function(){return Array.from(this.modulesByIdentifier.values())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contexts",{get:function(){return this.modules.reduce((function(e,t){return e.concat(t.contexts)}),[])},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.scopeObserver.start()},e.prototype.stop=function(){this.scopeObserver.stop()},e.prototype.loadDefinition=function(e){this.unloadIdentifier(e.identifier);var t=new $(this.application,e);this.connectModule(t)},e.prototype.unloadIdentifier=function(e){var t=this.modulesByIdentifier.get(e);t&&this.disconnectModule(t)},e.prototype.getContextForElementAndIdentifier=function(e,t){var n=this.modulesByIdentifier.get(t);if(n)return n.contexts.find((function(t){return t.element==e}))},e.prototype.handleError=function(e,t,n){this.application.handleError(e,t,n)},e.prototype.createScopeForElementAndIdentifier=function(e,t){return new Y(this.schema,e,t,this.logger)},e.prototype.scopeConnected=function(e){this.scopesByIdentifier.add(e.identifier,e);var t=this.modulesByIdentifier.get(e.identifier);t&&t.connectContextForScope(e)},e.prototype.scopeDisconnected=function(e){this.scopesByIdentifier.delete(e.identifier,e);var t=this.modulesByIdentifier.get(e.identifier);t&&t.disconnectContextForScope(e)},e.prototype.connectModule=function(e){this.modulesByIdentifier.set(e.identifier,e),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach((function(t){return e.connectContextForScope(t)}))},e.prototype.disconnectModule=function(e){this.modulesByIdentifier.delete(e.identifier),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach((function(t){return e.disconnectContextForScope(t)}))},e}(),ee={controllerAttribute:"data-controller",actionAttribute:"data-action",targetAttribute:"data-target"},te=globalThis&&globalThis.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},ne=globalThis&&globalThis.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(a){i=[6,a],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},re=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r},oe=function(){function e(e,t){void 0===e&&(e=document.documentElement),void 0===t&&(t=ee),this.logger=console,this.element=e,this.schema=t,this.dispatcher=new d(this),this.router=new Z(this)}return e.start=function(t,n){var r=new e(t,n);return r.start(),r},e.prototype.start=function(){return te(this,void 0,void 0,(function(){return ne(this,(function(e){switch(e.label){case 0:return[4,new Promise((function(e){"loading"==document.readyState?document.addEventListener("DOMContentLoaded",e):e()}))];case 1:return e.sent(),this.dispatcher.start(),this.router.start(),[2]}}))}))},e.prototype.stop=function(){this.dispatcher.stop(),this.router.stop()},e.prototype.register=function(e,t){this.load({identifier:e,controllerConstructor:t})},e.prototype.load=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=Array.isArray(e)?e:re([e],n);o.forEach((function(e){return t.router.loadDefinition(e)}))},e.prototype.unload=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=Array.isArray(e)?e:re([e],n);o.forEach((function(e){return t.router.unloadIdentifier(e)}))},Object.defineProperty(e.prototype,"controllers",{get:function(){return this.router.contexts.map((function(e){return e.controller}))},enumerable:!1,configurable:!0}),e.prototype.getControllerForElementAndIdentifier=function(e,t){var n=this.router.getContextForElementAndIdentifier(e,t);return n?n.controller:null},e.prototype.handleError=function(e,t,n){this.logger.error("%s\n\n%o\n\n%o",t,e,n)},e}();function ie(e){return _(e,"classes").reduce((function(e,t){return Object.assign(e,((r={})[o=(n=t)+"Class"]={get:function(){var e=this.classes;if(e.has(n))return e.get(n);var t=e.getAttributeName(n);throw new Error('Missing attribute "'+t+'"')}},r["has"+z(o)]={get:function(){return this.classes.has(n)}},r));var n,r,o}),{})}function se(e){return _(e,"targets").reduce((function(e,t){return Object.assign(e,((r={})[(n=t)+"Target"]={get:function(){var e=this.targets.find(n);if(e)return e;throw new Error('Missing target element "'+this.identifier+"."+n+'"')}},r[n+"Targets"]={get:function(){return this.targets.findAll(n)}},r["has"+z(n)+"Target"]={get:function(){return this.targets.has(n)}},r));var n,r}),{})}function ae(e){var t=M(e,"values"),n={valueDescriptorMap:{get:function(){var e=this;return t.reduce((function(t,n){var r,o=ce(n),i=e.data.getAttributeNameForKey(o.key);return Object.assign(t,((r={})[i]=o,r))}),{})}}};return t.reduce((function(e,t){return Object.assign(e,function(e){var t,n=ce(e),r=n.type,o=n.key,i=n.name,s=ue[r],a=de[r]||de.default;return(t={})[i]={get:function(){var e=this.data.get(o);return null!==e?s(e):n.defaultValue},set:function(e){void 0===e?this.data.delete(o):this.data.set(o,a(e))}},t["has"+z(i)]={get:function(){return this.data.has(o)}},t}(t))}),n)}function ce(e){var t=e[0],n=function(e){switch(e){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}throw new Error('Unknown value type constant "'+e+'"')}(e[1]);return function(e,t){var n=q(e)+"-value";return{type:t,key:n,name:U(n),get defaultValue(){return le[t]}}}(t,n)}var le={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},ue={array:function(e){var t=JSON.parse(e);if(!Array.isArray(t))throw new TypeError("Expected array");return t},boolean:function(e){return!("0"==e||"false"==e)},number:function(e){return parseFloat(e)},object:function(e){var t=JSON.parse(e);if(null===t||"object"!=typeof t||Array.isArray(t))throw new TypeError("Expected object");return t},string:function(e){return e}},de={default:function(e){return""+e},array:pe,object:pe};function pe(e){return JSON.stringify(e)}var fe=function(){function e(e){this.context=e}return Object.defineProperty(e.prototype,"application",{get:function(){return this.context.application},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scope",{get:function(){return this.context.scope},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this.scope.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"identifier",{get:function(){return this.scope.identifier},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"targets",{get:function(){return this.scope.targets},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"classes",{get:function(){return this.scope.classes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.scope.data},enumerable:!1,configurable:!0}),e.prototype.initialize=function(){},e.prototype.connect=function(){},e.prototype.disconnect=function(){},e.blessings=[ie,se,ae],e.targets=[],e.values={},e}();const he=()=>{const e=window.crypto||window.msCrypto;return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(t=>(t^e.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)))},me=(e,t=!0)=>"string"!=typeof e?"":(e=e.replace(/[\s_](.)/g,(e=>e.toUpperCase())).replace(/[\s_]/g,"").replace(/^(.)/,(e=>e.toLowerCase())),t&&(e=e.substr(0,1).toUpperCase()+e.substr(1)),e),ge=(e,t)=>{document.dispatchEvent(new CustomEvent(e,{bubbles:!0,cancelable:!1,detail:t})),window.jQuery&&window.jQuery(document).trigger(e,t)},be=e=>{if(""!==e.id)return"//*[@id='"+e.id+"']";if(e===document.body)return"/html/body";let t=0;const n=e.parentNode.childNodes;for(var r=0;r<n.length;r++){const o=n[r];if(o===e){return`${be(e.parentNode)}/${e.tagName.toLowerCase()}[${t+1}]`}1===o.nodeType&&o.tagName===e.tagName&&t++}},ye=e=>document.evaluate(e,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue,ve=(e,t=!1)=>{const n=document.evaluate(e,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),r=[];for(let o=0;o<n.snapshotLength;o++)r.push(n.snapshotItem(o));return t?r.reverse():r};let we=!1;var xe={get enabled(){return we},get disabled(){return!we},get value(){return we},set(e){we=!!e},set debug(e){we=!!e}};const Ae={INPUT:!0,TEXTAREA:!0,SELECT:!0},Ee={INPUT:!0,TEXTAREA:!0,OPTION:!0},Oe={"datetime-local":!0,"select-multiple":!0,"select-one":!0,color:!0,date:!0,datetime:!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,textarea:!0,time:!0,url:!0,week:!0};let Se;var Ce={get element(){return Se},set(e){Se=e}};const Te=e=>{const t=(e&&e.nodeType===Node.ELEMENT_NODE?e:document.querySelector(e))||Ce.element;t&&t.focus&&t.focus()},ke=(e,t,n={})=>{const r=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e.dispatchEvent(r),window.jQuery&&window.jQuery(e).trigger(t,n)},je=e=>Array(e).flat(),Ne=(e,t)=>{Array.from(e.selectAll?e.element:[e.element]).forEach(t)},Pe=e=>e.split("").map(((e,t)=>e.toUpperCase()===e?`${0!==t?"-":""}${e.toLowerCase()}`:e)).join(""),_e=(e,t)=>!e.cancel&&(e.delay?setTimeout(t,e.delay):t(),!0),Me=(e,t)=>ke(e,`cable-ready:before-${Pe(t.operation)}`,t),Ie=(e,t)=>ke(e,`cable-ready:after-${Pe(t.operation)}`,t);async function Re(e,t){try{const n=await fetch(e,{headers:a({"X-REQUESTED-WITH":"XmlHttpRequest"},t)});if(null==n)return;return function(e){if(!e.ok)throw Error(e.statusText)}(n),n}catch(n){console.error(`Could not fetch ${e}`)}}const Le=e=>(t,n)=>!Be.map((r=>"function"!=typeof r||r(e,t,n))).includes(!1),De=e=>t=>{Fe.forEach((n=>{"function"==typeof n&&n(e,t)}))},Be=[(e,t,n)=>!(!Ee[t.tagName]&&t.isEqualNode(n)),(e,t,n)=>{const{permanentAttributeName:r}=e;if(!r)return!0;const o=t.closest(`[${r}]`);if(!o&&t===Ce.element&&(Ae[(i=t).tagName]&&Oe[i.type])){const e={value:!0};return Array.from(n.attributes).forEach((n=>{e[n.name]||t.setAttribute(n.name,n.value)})),!1}var i;return!o},(e,t,n)=>t!==Ce.element||!t.isContentEditable],Fe=[];var $e;var Ve="undefined"==typeof document?void 0:document,Ue=!!Ve&&"content"in Ve.createElement("template"),ze=!!Ve&&Ve.createRange&&"createContextualFragment"in Ve.createRange();function qe(e){return e=e.trim(),Ue?function(e){var t=Ve.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}(e):ze?function(e){return $e||($e=Ve.createRange()).selectNode(Ve.body),$e.createContextualFragment(e).childNodes[0]}(e):function(e){var t=Ve.createElement("body");return t.innerHTML=e,t.childNodes[0]}(e)}function Ke(e,t){var n,r,o=e.nodeName,i=t.nodeName;return o===i||(n=o.charCodeAt(0),r=i.charCodeAt(0),n<=90&&r>=97?o===i.toUpperCase():r<=90&&n>=97&&i===o.toUpperCase())}function He(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n))}var We={OPTION:function(e,t){var n=e.parentNode;if(n){var r=n.nodeName.toUpperCase();"OPTGROUP"===r&&(r=(n=n.parentNode)&&n.nodeName.toUpperCase()),"SELECT"!==r||n.hasAttribute("multiple")||(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),n.selectedIndex=-1)}He(e,t,"selected")},INPUT:function(e,t){He(e,t,"checked"),He(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var n=t.value;e.value!==n&&(e.value=n);var r=e.firstChild;if(r){var o=r.nodeValue;if(o==n||!n&&o==e.placeholder)return;r.nodeValue=n}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var n,r,o=-1,i=0,s=e.firstChild;s;)if("OPTGROUP"===(r=s.nodeName&&s.nodeName.toUpperCase()))s=(n=s).firstChild;else{if("OPTION"===r){if(s.hasAttribute("selected")){o=i;break}i++}!(s=s.nextSibling)&&n&&(s=n.nextSibling,n=null)}e.selectedIndex=o}}};function Qe(){}function Xe(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}var Je,Ye=(Je=function(e,t){var n,r,o,i,s=t.attributes;if(11!==t.nodeType&&11!==e.nodeType){for(var a=s.length-1;a>=0;a--)r=(n=s[a]).name,o=n.namespaceURI,i=n.value,o?(r=n.localName||r,e.getAttributeNS(o,r)!==i&&("xmlns"===n.prefix&&(r=n.name),e.setAttributeNS(o,r,i))):e.getAttribute(r)!==i&&e.setAttribute(r,i);for(var c=e.attributes,l=c.length-1;l>=0;l--)r=(n=c[l]).name,(o=n.namespaceURI)?(r=n.localName||r,t.hasAttributeNS(o,r)||e.removeAttributeNS(o,r)):t.hasAttribute(r)||e.removeAttribute(r)}},function(e,t,n){if(n||(n={}),"string"==typeof t)if("#document"===e.nodeName||"HTML"===e.nodeName||"BODY"===e.nodeName){var r=t;(t=Ve.createElement("html")).innerHTML=r}else t=qe(t);var o=n.getNodeKey||Xe,i=n.onBeforeNodeAdded||Qe,s=n.onNodeAdded||Qe,a=n.onBeforeElUpdated||Qe,c=n.onElUpdated||Qe,l=n.onBeforeNodeDiscarded||Qe,u=n.onNodeDiscarded||Qe,d=n.onBeforeElChildrenUpdated||Qe,p=!0===n.childrenOnly,f=Object.create(null),h=[];function m(e){h.push(e)}function g(e,t){if(1===e.nodeType)for(var n=e.firstChild;n;){var r=void 0;t&&(r=o(n))?m(r):(u(n),n.firstChild&&g(n,t)),n=n.nextSibling}}function b(e,t,n){!1!==l(e)&&(t&&t.removeChild(e),u(e),g(e,n))}function y(e){s(e);for(var t=e.firstChild;t;){var n=t.nextSibling,r=o(t);if(r){var i=f[r];i&&Ke(t,i)?(t.parentNode.replaceChild(i,t),v(i,t)):y(t)}else y(t);t=n}}function v(e,t,n){var r=o(t);if(r&&delete f[r],!n){if(!1===a(e,t))return;if(Je(e,t),c(e),!1===d(e,t))return}"TEXTAREA"!==e.nodeName?function(e,t){var n,r,s,a,c,l=t.firstChild,u=e.firstChild;e:for(;l;){for(a=l.nextSibling,n=o(l);u;){if(s=u.nextSibling,l.isSameNode&&l.isSameNode(u)){l=a,u=s;continue e}r=o(u);var d=u.nodeType,p=void 0;if(d===l.nodeType&&(1===d?(n?n!==r&&((c=f[n])?s===c?p=!1:(e.insertBefore(c,u),r?m(r):b(u,e,!0),u=c):p=!1):r&&(p=!1),(p=!1!==p&&Ke(u,l))&&v(u,l)):3!==d&&8!=d||(p=!0,u.nodeValue!==l.nodeValue&&(u.nodeValue=l.nodeValue))),p){l=a,u=s;continue e}r?m(r):b(u,e,!0),u=s}if(n&&(c=f[n])&&Ke(c,l))e.appendChild(c),v(c,l);else{var h=i(l);!1!==h&&(h&&(l=h),l.actualize&&(l=l.actualize(e.ownerDocument||Ve)),e.appendChild(l),y(l))}l=a,u=s}!function(e,t,n){for(;t;){var r=t.nextSibling;(n=o(t))?m(n):b(t,e,!0),t=r}}(e,u,r);var g=We[e.nodeName];g&&g(e,t)}(e,t):We.TEXTAREA(e,t)}!function e(t){if(1===t.nodeType||11===t.nodeType)for(var n=t.firstChild;n;){var r=o(n);r&&(f[r]=n),e(n),n=n.nextSibling}}(e);var w,x,A=e,E=A.nodeType,O=t.nodeType;if(!p)if(1===E)1===O?Ke(e,t)||(u(e),A=function(e,t){for(var n=e.firstChild;n;){var r=n.nextSibling;t.appendChild(n),n=r}return t}(e,(w=t.nodeName,(x=t.namespaceURI)&&"http://www.w3.org/1999/xhtml"!==x?Ve.createElementNS(x,w):Ve.createElement(w)))):A=t;else if(3===E||8===E){if(O===E)return A.nodeValue!==t.nodeValue&&(A.nodeValue=t.nodeValue),A;A=t}if(A===t)u(e);else{if(t.isSameNode&&t.isSameNode(A))return;if(v(A,t,p),h)for(var S=0,C=h.length;S<C;S++){var T=f[h[S]];T&&b(T,T.parentNode,!1)}}return!p&&A!==e&&e.parentNode&&(A.actualize&&(A=A.actualize(e.ownerDocument||Ve)),e.parentNode.replaceChild(A,e)),A});let Ge={append:e=>{Ne(e,(t=>{Me(t,e),_e(e,(()=>{const{html:n,focusSelector:r}=e;t.insertAdjacentHTML("beforeend",n||""),Te(r)})),Ie(t,e)}))},graft:e=>{Ne(e,(t=>{Me(t,e),_e(e,(()=>{const{parent:n,focusSelector:r}=e,o=document.querySelector(n);o&&(o.appendChild(t),Te(r))})),Ie(t,e)}))},innerHtml:e=>{Ne(e,(t=>{Me(t,e),_e(e,(()=>{const{html:n,focusSelector:r}=e;t.innerHTML=n||"",Te(r)})),Ie(t,e)}))},insertAdjacentHtml:e=>{Ne(e,(t=>{Me(t,e),_e(e,(()=>{const{html:n,position:r,focusSelector:o}=e;t.insertAdjacentHTML(r||"beforeend",n||""),Te(o)})),Ie(t,e)}))},insertAdjacentText:e=>{Ne(e,(t=>{Me(t,e),_e(e,(()=>{const{text:n,position:r,focusSelector:o}=e;t.insertAdjacentText(r||"beforeend",n||""),Te(o)})),Ie(t,e)}))},morph:e=>{Ne(e,(t=>{const{html:n}=e,r=document.createElement("template");r.innerHTML=String(n).trim(),e.content=r.content;const o=t.parentElement,i=Array.from(o.children).indexOf(t);Me(t,e),_e(e,(()=>{const{childrenOnly:n,focusSelector:o}=e;Ye(t,n?r.content:r.innerHTML,{childrenOnly:!!n,onBeforeElUpdated:Le(e),onElUpdated:De(e)}),Te(o)})),Ie(o.children[i],e)}))},outerHtml:e=>{Ne(e,(t=>{const n=t.parentElement,r=Array.from(n.children).indexOf(t);Me(t,e),_e(e,(()=>{const{html:n,focusSelector:r}=e;t.outerHTML=n||"",Te(r)})),Ie(n.children[r],e)}))},prepend:e=>{Ne(e,(t=>{Me(t,e),_e(e,(()=>{const{html:n,focusSelector:r}=e;t.insertAdjacentHTML("afterbegin",n||""),Te(r)})),Ie(t,e)}))},remove:e=>{Ne(e,(t=>{Me(t,e),_e(e,(()=>{const{focusSelector:n}=e;t.remove(),Te(n)})),Ie(document,e)}))},replace:e=>{Ne(e,(t=>{const n=t.parentElement,r=Array.from(n.children).indexOf(t);Me(t,e),_e(e,(()=>{const{html:n,focusSelector:r}=e;t.outerHTML=n||"",Te(r)})),Ie(n.children[r],e)}))},textContent:e=>{Ne(e,(t=>{Me(t,e),_e(e,(()=>{const{text:n,focusSelector:r}=e;t.textContent=n||"",Te(r)})),Ie(t,e)}))},addCssClass:e=>{Ne(e,(t=>{Me(t,e),_e(e,(()=>{const{name:n}=e;t.classList.add(...je(n||""))})),Ie(t,e)}))},removeAttribute:e=>{Ne(e,(t=>{Me(t,e),_e(e,(()=>{const{name:n}=e;t.removeAttribute(n)})),Ie(t,e)}))},removeCssClass:e=>{Ne(e,(t=>{Me(t,e),_e(e,(()=>{const{name:n}=e;t.classList.remove(...je(n))})),Ie(t,e)}))},setAttribute:e=>{Ne(e,(t=>{Me(t,e),_e(e,(()=>{const{name:n,value:r}=e;t.setAttribute(n,r||"")})),Ie(t,e)}))},setDatasetProperty:e=>{Ne(e,(t=>{Me(t,e),_e(e,(()=>{const{name:n,value:r}=e;t.dataset[n]=r||""})),Ie(t,e)}))},setProperty:e=>{Ne(e,(t=>{Me(t,e),_e(e,(()=>{const{name:n,value:r}=e;n in t&&(t[n]=r||"")})),Ie(t,e)}))},setStyle:e=>{Ne(e,(t=>{Me(t,e),_e(e,(()=>{const{name:n,value:r}=e;t.style[n]=r||""})),Ie(t,e)}))},setStyles:e=>{Ne(e,(t=>{Me(t,e),_e(e,(()=>{const{styles:n}=e;for(let[e,r]of Object.entries(n))t.style[e]=r||""})),Ie(t,e)}))},setValue:e=>{Ne(e,(t=>{Me(t,e),_e(e,(()=>{const{value:n}=e;t.value=n||""})),Ie(t,e)}))},dispatchEvent:e=>{Ne(e,(t=>{Me(t,e),_e(e,(()=>{const{name:n,detail:r}=e;ke(t,n,r)})),Ie(t,e)}))},setMeta:e=>{Me(document,e),_e(e,(()=>{const{name:t,content:n}=e;let r=document.head.querySelector(`meta[name='${t}']`);r||(r=document.createElement("meta"),r.name=t,document.head.appendChild(r)),r.content=n})),Ie(document,e)},clearStorage:e=>{Me(document,e),_e(e,(()=>{const{type:t}=e;("session"===t?sessionStorage:localStorage).clear()})),Ie(document,e)},go:e=>{Me(window,e),_e(e,(()=>{const{delta:t}=e;history.go(t)})),Ie(window,e)},pushState:e=>{Me(window,e),_e(e,(()=>{const{state:t,title:n,url:r}=e;history.pushState(t||{},n||"",r)})),Ie(window,e)},redirectTo:e=>{Me(window,e),_e(e,(()=>{let{url:t,action:n}=e;n=n||"advance",window.Turbo&&window.Turbo.visit(t,{action:n}),window.Turbolinks&&window.Turbolinks.visit(t,{action:n}),window.Turbo||window.Turbolinks||(window.location.href=t)})),Ie(window,e)},reload:e=>{Me(window,e),_e(e,(()=>{window.location.reload()})),Ie(window,e)},removeStorageItem:e=>{Me(document,e),_e(e,(()=>{const{key:t,type:n}=e;("session"===n?sessionStorage:localStorage).removeItem(t)})),Ie(document,e)},replaceState:e=>{Me(window,e),_e(e,(()=>{const{state:t,title:n,url:r}=e;history.replaceState(t||{},n||"",r)})),Ie(window,e)},scrollIntoView:e=>{const{element:t}=e;Me(t,e),_e(e,(()=>{t.scrollIntoView(e)})),Ie(t,e)},setCookie:e=>{Me(document,e),_e(e,(()=>{const{cookie:t}=e;document.cookie=t||""})),Ie(document,e)},setFocus:e=>{const{element:t}=e;Me(t,e),_e(e,(()=>{Te(t)})),Ie(t,e)},setStorageItem:e=>{Me(document,e),_e(e,(()=>{const{key:t,value:n,type:r}=e;("session"===r?sessionStorage:localStorage).setItem(t,n||"")})),Ie(document,e)},consoleLog:e=>{Me(document,e),_e(e,(()=>{const{message:t,level:n}=e;n&&["warn","info","error"].includes(n)?console[n](t||""):console.log(t||"")})),Ie(document,e)},consoleTable:e=>{Me(document,e),_e(e,(()=>{const{data:t,columns:n}=e;console.table(t,n||[])})),Ie(document,e)},notification:e=>{Me(document,e),_e(e,(()=>{const{title:t,options:n}=e;Notification.requestPermission().then((r=>{e.permission=r,"granted"===r&&new Notification(t||"",n)}))})),Ie(document,e)}};const Ze=e=>{Ge=a(a({},Ge),e)};var et={get all(){return Ge}};let tt;const nt=async()=>tt||(await new Promise((e=>setTimeout(e))),nt());var rt={setConsumer(e){tt=e},getConsumer:async()=>new Promise(((e,t)=>{tt=nt(),e(tt)}))};class ot extends HTMLElement{disconnectedCallback(){this.channel&&this.channel.unsubscribe()}createSubscription(e,t,n){this.channel=e.subscriptions.create({channel:t,identifier:this.getAttribute("identifier")},{received:n})}get preview(){return document.documentElement.hasAttribute("data-turbolinks-preview")||document.documentElement.hasAttribute("data-turbo-preview")}}class it extends ot{async connectedCallback(){if(this.preview)return;const e=await ut.consumer;e?this.createSubscription(e,"CableReady::Stream",this.performOperations):console.error("The `stream_from` helper cannot connect without an ActionCable consumer.\nPlease run `rails generate cable_ready:helpers` to fix this.")}performOperations(e){e.cableReady&&ut.perform(e.operations)}}function st(e){return e.hasAttribute("url")?e.getAttribute("url"):location.href}class at extends ot{constructor(){super();this.attachShadow({mode:"open"}).innerHTML="\n<style>\n  :host {\n    display: block;\n  }\n</style>\n<slot></slot>\n"}async connectedCallback(){if(this.preview)return;this.update=function(e,t){let n;return(...r)=>{clearTimeout(n),n=setTimeout((()=>e.apply(this,r)),t)}}(this.update.bind(this),this.debounce);const e=await ut.consumer;e?this.createSubscription(e,"CableReady::Stream",this.update):console.error("The `updates-for` helper cannot connect without an ActionCable consumer.\nPlease run `rails generate cable_ready:helpers` to fix this.")}async update(e){const t=`updates-for[identifier="${this.getAttribute("identifier")}"]`,n=document.querySelectorAll(t);if(n[0]!==this)return;const r=this.getAttribute("only");if(r&&e.changed&&!r.split(" ").some((t=>e.changed.includes(t))))return;const o={},i=document.createElement("template");for(let s=0;s<n.length;s++){if(n[s].setAttribute("updating","updating"),!o.hasOwnProperty(st(n[s]))){const e=await Re(st(n[s]),{"X-Cable-Ready":"update"});o[st(n[s])]=await e.text()}i.innerHTML=String(o[st(n[s])]).trim(),await this.resolveTurboFrames(i.content);const e=i.content.querySelectorAll(t);if(e.length<=s)return void console.warn("Update aborted due to mismatched number of elements");Ce.set(document.activeElement);const r={element:n[s],html:e[s],permanentAttributeName:"data-ignore-updates"};ke(n[s],"cable-ready:before-update",r),Ye(n[s],e[s],{childrenOnly:!0,onBeforeElUpdated:Le(r),onElUpdated:e=>{n[s].removeAttribute("updating"),ke(n[s],"cable-ready:after-update",r),Te(r.focusSelector)}})}}async resolveTurboFrames(e){const t=[...e.querySelectorAll('turbo-frame[src]:not([loading="lazy"])')];return Promise.all(t.map((t=>new Promise((async n=>{const r=await Re(t.getAttribute("src"),{"Turbo-Frame":t.id,"X-Cable-Ready":"update"}),o=document.createElement("template");o.innerHTML=await r.text(),await this.resolveTurboFrames(o.content),e.querySelector(`turbo-frame#${t.id}`).innerHTML=String(o.content.querySelector(`turbo-frame#${t.id}`).innerHTML).trim(),n()})))))}get debounce(){return this.hasAttribute("debounce")?parseInt(this.getAttribute("debounce")):20}}const ct=(e,t={emitMissingElementWarnings:!0})=>{const n={};e.forEach((e=>{e.batch&&(n[e.batch]=n[e.batch]?++n[e.batch]:1)})),e.forEach((e=>{const r=e.operation;try{if(e.selector?e.element=e.xpath?(o=e.selector,document.evaluate(o,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):document[e.selectAll?"querySelectorAll":"querySelector"](e.selector):e.element=document,e.element||t.emitMissingElementWarnings){Ce.set(document.activeElement);const t=et.all[r];t?(t(e),e.batch&&0==--n[e.batch]&&ke(document,"cable-ready:batch-complete",{batch:e.batch})):console.error(`CableReady couldn't find the "${r}" operation. Make sure you use the camelized form when calling an operation method.`)}}catch(i){e.element?(console.error(`CableReady detected an error in ${r}: ${i.message}. If you need to support older browsers make sure you've included the corresponding polyfills. https://docs.stimulusreflex.com/setup#polyfills-for-ie11.`),console.error(i)):console.warn(`CableReady ${r} failed due to missing DOM element for selector: '${e.selector}'`)}var o}))},lt=rt.getConsumer();var ut={perform:ct,performAsync:(e,t={emitMissingElementWarnings:!0})=>new Promise(((n,r)=>{try{n(ct(e,t))}catch(o){r(o)}})),shouldMorphCallbacks:Be,didMorphCallbacks:Fe,initialize:(e={})=>{const{consumer:t}=e;rt.setConsumer(t),customElements.get("stream-from")||customElements.define("stream-from",it),customElements.get("updates-for")||customElements.define("updates-for",at)},consumer:lt,addOperation:(e,t)=>{const n={};n[e]=t,Ze(n)},addOperations:e=>{Ze(e)},version:"5.0.0-pre8",get DOMOperations(){return console.warn("DEPRECATED: Please use `CableReady.operations` instead of `CableReady.DOMOperations`"),et.all},get operations(){return et.all}};const dt={reflexAttribute:"data-reflex",reflexPermanentAttribute:"data-reflex-permanent",reflexRootAttribute:"data-reflex-root",reflexSuppressLoggingAttribute:"data-reflex-suppress-logging",reflexDatasetAttribute:"data-reflex-dataset",reflexDatasetAllAttribute:"data-reflex-dataset-all",reflexSerializeFormAttribute:"data-reflex-serialize-form",reflexFormSelectorAttribute:"data-reflex-form-selector",reflexIncludeInnerHtmlAttribute:"data-reflex-include-inner-html",reflexIncludeTextContentAttribute:"data-reflex-include-text-content"};let pt={};var ft={set(e){pt=a(a({},dt),e.schema);for(const t in pt)Object.defineProperty(this,t.slice(0,-9),{get:()=>pt[t]})}};let ht=!1;var mt={get disabled(){return!ht},set(e){ht=e}};let gt=!0;var bt={get enabled(){return gt},get disabled(){return!gt},get value(){return gt},set(e){gt=!!e},set deprecate(e){gt=!!e}};const yt=(e=[])=>{const t=e.filter((e=>e&&String(e).length)).map((e=>e.trim())).join(" ").trim();return t.length?t:null},vt=e=>e&&e.length?e.split(" ").filter((e=>e.trim().length)):[],wt=e=>{let t=Array.from(e.attributes).reduce(((e,t)=>(e[t.name]=t.value,e)),{});if(t.checked=!!e.checked,t.selected=!!e.selected,t.tag_name=e.tagName,e.tagName.match(/select/i)||(e=>!!["checkbox","radio"].includes(e.type)&&document.querySelectorAll(`input[type="${e.type}"][name="${e.name}"]`).length>1)(e)){const n=(e=>Array.from(e.querySelectorAll("option:checked")).concat(Array.from(document.querySelectorAll(`input[type="${e.type}"][name="${e.name}"]`)).filter((e=>e.checked))).map((e=>e.value)))(e);t.values=n,t.value=n.join(",")}else t.value=e.value;return t},xt=(e,t)=>{if(!t||0===t.length)return[];let n=[e];const r=be(e);return t.forEach((e=>{try{switch(e){case"combined":bt.enabled&&console.warn("In the next version of StimulusReflex, the 'combined' option to data-reflex-dataset will become 'ancestors'."),n=[...n,...ve(`${r}/ancestor::*`,!0)];break;case"ancestors":n=[...n,...ve(`${r}/ancestor::*`,!0)];break;case"parent":n=[...n,...ve(`${r}/parent::*`)];break;case"siblings":n=[...n,...ve(`${r}/preceding-sibling::*|${r}/following-sibling::*`)];break;case"children":n=[...n,...ve(`${r}/child::*`)];break;case"descendants":n=[...n,...ve(`${r}/descendant::*`)];break;default:n=[...n,...document.querySelectorAll(e)]}}catch(t){xe.enabled&&console.error(t)}})),n},At=e=>{let t={};return e&&e.attributes&&Array.from(e.attributes).forEach((e=>{e.name.startsWith("data-")&&(t[e.name]=e.value)})),t},Et=(e,t)=>vt(t.getAttribute(ft.controller)).reduce(((n,r)=>{const o=e.getControllerForElementAndIdentifier(t,r);return o&&o.StimulusReflex&&n.push(o),n}),[]),Ot={},St=e=>{if(!e.cableReady)return;let t,n=[];for(let r=e.operations.length-1;r>=0;r--)e.operations[r].stimulusReflex&&(n.push(e.operations[r]),e.operations.splice(r,1));if(!n.some((e=>e.stimulusReflex.url!==location.href)))if(n.length&&(t=n[0].stimulusReflex,t.payload=n[0].payload),t){const{reflexId:r,payload:o}=t;if(!Ot[r]&&mt.disabled){const e=ye(t.xpathController),n=ye(t.xpathElement);e.reflexController=e.reflexController||{},e.reflexData=e.reflexData||{},e.reflexError=e.reflexError||{},e.reflexController[r]=Ot.app.getControllerForElementAndIdentifier(e,t.reflexController),e.reflexData[r]=t,jt("before",n,e,r,o),Ct(t)}Ot[r]&&(Ot[r].totalOperations=n.length,Ot[r].pendingOperations=n.length,Ot[r].completedOperations=0,Ot[r].piggybackOperations=e.operations,ut.perform(n))}else e.operations.length&&Ot[e.operations[0].reflexId]&&ut.perform(e.operations)},Ct=e=>{const{reflexId:t}=e;Ot[t]={finalStage:"finalize"};const n=new Promise(((n,r)=>{Ot[t].promise={resolve:n,reject:r,data:e}}));return n.reflexId=t,xe.enabled&&n.catch((()=>{})),n},Tt=((e,t=250)=>{let n;return(...r)=>{clearTimeout(n),n=setTimeout((()=>{n=null,e(...r)}),t)}})((()=>{document.querySelectorAll(`[${ft.reflex}]`).forEach((e=>{const t=vt(e.getAttribute(ft.controller)),n=vt(e.getAttribute(ft.reflex)),r=vt(e.getAttribute(ft.action));n.forEach((n=>{const o=((e,t)=>t.find((t=>{if(t.identifier)return(e=>{const t=e.match(/(?:.*->)?(.*?)(?:Reflex)?#/);return t?t[1]:""})(e).replace(/([a-z0–9])([A-Z])/g,"$1-$2").replace(/(::)/g,"--").toLowerCase()===t.identifier}))||t[0])(n,((e,t)=>{let n=[];for(;t;)n=n.concat(Et(e,t)),t=t.parentElement;return n})(Ot.app,e));let i;o?(i=`${n.split("->")[0]}->${o.identifier}#__perform`,r.includes(i)||r.push(i)):(i=`${n.split("->")[0]}->stimulus-reflex#__perform`,t.includes("stimulus-reflex")||t.push("stimulus-reflex"),r.includes(i)||r.push(i))}));const o=yt(t),i=yt(r);o&&e.getAttribute(ft.controller)!=o&&e.setAttribute(ft.controller,o),i&&e.getAttribute(ft.action)!=i&&e.setAttribute(ft.action,i)})),ge("stimulus-reflex:ready")}),20),kt=(e,t,n,r,o)=>{if(!n||!n.reflexData[r])return;const i=n.reflexController[r],s=n.reflexData[r].target,a=s.split("#")[1],c=i[["before","after","finalize"].includes(e)?`${e}${me(a)}`:`${me(a,!1)}${me(e)}`],l=i[["before","after","finalize"].includes(e)?`${e}Reflex`:`reflex${me(e)}`];"function"==typeof c&&c.call(i,t,s,n.reflexError[r],r,o),"function"==typeof l&&l.call(i,t,s,n.reflexError[r],r,o),Ot[r]&&e===Ot[r].finalStage&&(Reflect.deleteProperty(n.reflexController,r),Reflect.deleteProperty(n.reflexData,r),Reflect.deleteProperty(n.reflexError,r))};document.addEventListener("stimulus-reflex:before",(e=>kt("before",e.detail.element,e.detail.controller.element,e.detail.reflexId,e.detail.payload)),!0),document.addEventListener("stimulus-reflex:success",(e=>{kt("success",e.detail.element,e.detail.controller.element,e.detail.reflexId,e.detail.payload),jt("after",e.detail.element,e.detail.controller.element,e.detail.reflexId,e.detail.payload)}),!0),document.addEventListener("stimulus-reflex:nothing",(e=>{jt("success",e.detail.element,e.detail.controller.element,e.detail.reflexId,e.detail.payload)}),!0),document.addEventListener("stimulus-reflex:error",(e=>{kt("error",e.detail.element,e.detail.controller.element,e.detail.reflexId,e.detail.payload),jt("after",e.detail.element,e.detail.controller.element,e.detail.reflexId,e.detail.payload)}),!0),document.addEventListener("stimulus-reflex:halted",(e=>kt("halted",e.detail.element,e.detail.controller.element,e.detail.reflexId,e.detail.payload)),!0),document.addEventListener("stimulus-reflex:after",(e=>kt("after",e.detail.element,e.detail.controller.element,e.detail.reflexId,e.detail.payload)),!0),document.addEventListener("stimulus-reflex:finalize",(e=>kt("finalize",e.detail.element,e.detail.controller.element,e.detail.reflexId,e.detail.payload)),!0);const jt=(e,t,n,r,o)=>{if(!n)return void(xe.enabled&&!Ot[r].warned&&(console.warn(`StimulusReflex was not able execute callbacks or emit events for "${e}" or later life-cycle stages for this Reflex. The StimulusReflex Controller Element is no longer present in the DOM. Could you move the StimulusReflex Controller to an element higher in your DOM?`),Ot[r].warned=!0));if(!n.reflexController||n.reflexController&&!n.reflexController[r])return void(xe.enabled&&!Ot[r].warned&&(console.warn(`StimulusReflex detected that the StimulusReflex Controller responsible for this Reflex has been replaced with a new instance. Callbacks and events for "${e}" or later life-cycle stages cannot be executed.`),Ot[r].warned=!0));const{target:i}=n.reflexData[r]||{},s=n.reflexController[r]||{},a=`stimulus-reflex:${e}`,c=`${a}:${i.split("#")[1]}`,l={reflex:i,controller:s,reflexId:r,element:t,payload:o},u={bubbles:!0,cancelable:!1,detail:l};n.dispatchEvent(new CustomEvent(a,u)),n.dispatchEvent(new CustomEvent(c,u)),window.jQuery&&(window.jQuery(n).trigger(a,l),window.jQuery(n).trigger(c,l))};var Nt=(e,t,n,r,o,i)=>{const s=Ot[e];xe.disabled||s.promise.data.suppressLogging||(s.timestamp=new Date,console.log(`↑ stimulus ↑ ${t}`,{reflexId:e,args:n,controller:r,element:o,controllerElement:i}))},Pt=(e,t)=>{const{detail:n}=e||{},{selector:r,payload:o}=n||{},{reflexId:i,target:s,morph:a}=n.stimulusReflex||{},c=Ot[i];if(xe.disabled||c.promise.data.suppressLogging)return;const l=c.totalOperations>1?` ${c.completedOperations}/${c.totalOperations}`:"",u=c.timestamp?`in ${new Date-c.timestamp}ms`:"CLONED",d=e.type.split(":")[1].split("-").slice(1).join("_");console.log(`↓ reflex ↓ ${s} → ${r||"∞"}${l} ${u}`,{reflexId:i,morph:a,operation:d,halted:t,payload:o})},_t=e=>{const{detail:t}=e||{},{reflexId:n,target:r,payload:o}=t.stimulusReflex||{},i=Ot[n];if(xe.disabled||i.promise.data.suppressLogging)return;const s=i.timestamp?`in ${new Date-i.timestamp}ms`:"CLONED";console.log(`↓ reflex ↓ ${r} ${s} %cERROR: ${e.detail.body}`,"color: #f00;",{reflexId:n,payload:o})};const Mt=e=>{const{stimulusReflex:t,payload:n}=e.detail||{};if(!t)return;const{reflexId:r,xpathElement:o,xpathController:i}=t,s=ye(i),a=ye(o),c=Ot[r],{promise:l}=c;c.pendingOperations--,c.pendingOperations>0||(t.resolveLate||setTimeout((()=>l.resolve({element:a,event:e,data:l.data,payload:n,reflexId:r,toString:()=>""}))),setTimeout((()=>jt("success",a,s,r,n))))},It=e=>{const{stimulusReflex:t,payload:n}=e.detail||{};if(!t)return;const{reflexId:r,xpathElement:o,xpathController:i}=t,s=ye(i),a=ye(o),c=Ot[r],{promise:l}=c;c.completedOperations++,Pt(e,!1),c.completedOperations<c.totalOperations||(t.resolveLate&&setTimeout((()=>l.resolve({element:a,event:e,data:l.data,payload:n,reflexId:r,toString:()=>""}))),setTimeout((()=>jt("finalize",a,s,r,n))),c.piggybackOperations.length&&ut.perform(c.piggybackOperations))},Rt=(e,t,n,r,o)=>{r.finalStage="after",Pt(e,!1),setTimeout((()=>n.resolve({data:n.data,element:o,event:e,payload:t,reflexId:n.data.reflexId,toString:()=>""})))},Lt=(e,t,n,r,o)=>{r.finalStage="halted",Pt(e,!0),setTimeout((()=>n.resolve({data:n.data,element:o,event:e,payload:t,reflexId:n.data.reflexId,toString:()=>""})))},Dt=(e,t,n,r,o)=>{r.finalStage="after",_t(e),setTimeout((()=>n.reject({data:n.data,element:o,event:e,payload:t,reflexId:n.data.reflexId,error:e.detail.body,toString:()=>e.detail.body})))};class Bt{constructor(e,t,n,r,o,i,s,a,c){this.options=e,this.reflexElement=t,this.controllerElement=n,this.reflexController=r,this.permanentAttributeName=o,this.target=i,this.args=s,this.url=a,this.tabId=c}get attrs(){return this._attrs=this._attrs||this.options.attrs||wt(this.reflexElement),this._attrs}get reflexId(){return this._reflexId=this._reflexId||this.options.reflexId||he(),this._reflexId}get selectors(){return this._selectors=this._selectors||this.options.selectors||(e=>{let t=[];for(;0===t.length&&e;){let n=e.getAttribute(ft.reflexRoot);if(n){0===n.length&&e.id&&(n=`#${e.id}`);const r=n.split(",").filter((e=>e.trim().length));xe.enabled&&0===r.length&&console.error(`No value found for ${ft.reflexRoot}. Add an #id to the element or provide a value for ${ft.reflexRoot}.`,e),t=t.concat(r.filter((e=>document.querySelector(e))))}e=e.parentElement?e.parentElement.closest(`[${ft.reflexRoot}]`):null}return t})(this.reflexElement),"string"==typeof this._selectors?[this._selectors]:this._selectors}get resolveLate(){return this.options.resolveLate||!1}get dataset(){return this._dataset=this._dataset||(e=>{const t=e.attributes[ft.reflexDataset],n=e.attributes[ft.reflexDatasetAll],r=t&&t.value.split(" ")||[],o=n&&n.value.split(" ")||[],i=xt(e,r),s=xt(e,o),c=i.reduce(((e,t)=>a(a({},At(t)),e)),{}),l=At(e),u={dataset:a(a({},l),c),datasetAll:{}};return s.forEach((e=>{const t=At(e);Object.keys(t).forEach((e=>{const n=t[e];u.datasetAll[e]&&Array.isArray(u.datasetAll[e])?u.datasetAll[e].push(n):u.datasetAll[e]=[n]}))})),u})(this.reflexElement),this._dataset}get innerHTML(){return this.includeInnerHtml?this.reflexElement.innerHTML:""}get textContent(){return this.includeTextContent?this.reflexElement.textContent:""}get xpathController(){return be(this.controllerElement)}get xpathElement(){return be(this.reflexElement)}get formSelector(){const e=this.reflexElement.attributes[ft.reflexFormSelector]?this.reflexElement.attributes[ft.reflexFormSelector].value:void 0;return this.options.formSelector||e}get includeInnerHtml(){const e=this.reflexElement.attributes[ft.reflexIncludeInnerHtml]||!1;return!(!this.options.includeInnerHTML&&!e)&&"false"!==e.value}get includeTextContent(){const e=this.reflexElement.attributes[ft.reflexIncludeTextContent]||!1;return!(!this.options.includeTextContent&&!e)&&"false"!==e.value}get suppressLogging(){return this.options.suppressLogging||this.reflexElement.attributes[ft.reflexSuppressLogging]||!1}valueOf(){return{attrs:this.attrs,dataset:this.dataset,selectors:this.selectors,reflexId:this.reflexId,resolveLate:this.resolveLate,suppressLogging:this.suppressLogging,xpathController:this.xpathController,xpathElement:this.xpathElement,inner_html:this.innerHTML,text_content:this.textContent,formSelector:this.formSelector,reflexController:this.reflexController,permanentAttributeName:this.permanentAttributeName,target:this.target,args:this.args,url:this.url,tabId:this.tabId}}}var Ft={exports:{}};let $t,Vt,Ut;!function(e){var t={logger:self.console,WebSocket:self.WebSocket},n={log:function(){if(this.enabled){for(var e,n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];r.push(Date.now()),(e=t.logger).log.apply(e,["[ActionCable]"].concat(r))}}},r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(){return(new Date).getTime()},a=function(e){return(s()-e)/1e3},c=function(e,t,n){return Math.max(t,Math.min(n,e))},l=function(){function e(t){o(this,e),this.visibilityDidChange=this.visibilityDidChange.bind(this),this.connection=t,this.reconnectAttempts=0}return e.prototype.start=function(){this.isRunning()||(this.startedAt=s(),delete this.stoppedAt,this.startPolling(),addEventListener("visibilitychange",this.visibilityDidChange),n.log("ConnectionMonitor started. pollInterval = "+this.getPollInterval()+" ms"))},e.prototype.stop=function(){this.isRunning()&&(this.stoppedAt=s(),this.stopPolling(),removeEventListener("visibilitychange",this.visibilityDidChange),n.log("ConnectionMonitor stopped"))},e.prototype.isRunning=function(){return this.startedAt&&!this.stoppedAt},e.prototype.recordPing=function(){this.pingedAt=s()},e.prototype.recordConnect=function(){this.reconnectAttempts=0,this.recordPing(),delete this.disconnectedAt,n.log("ConnectionMonitor recorded connect")},e.prototype.recordDisconnect=function(){this.disconnectedAt=s(),n.log("ConnectionMonitor recorded disconnect")},e.prototype.startPolling=function(){this.stopPolling(),this.poll()},e.prototype.stopPolling=function(){clearTimeout(this.pollTimeout)},e.prototype.poll=function(){var e=this;this.pollTimeout=setTimeout((function(){e.reconnectIfStale(),e.poll()}),this.getPollInterval())},e.prototype.getPollInterval=function(){var e=this.constructor.pollInterval,t=e.min,n=e.max,r=e.multiplier*Math.log(this.reconnectAttempts+1);return Math.round(1e3*c(r,t,n))},e.prototype.reconnectIfStale=function(){this.connectionIsStale()&&(n.log("ConnectionMonitor detected stale connection. reconnectAttempts = "+this.reconnectAttempts+", pollInterval = "+this.getPollInterval()+" ms, time disconnected = "+a(this.disconnectedAt)+" s, stale threshold = "+this.constructor.staleThreshold+" s"),this.reconnectAttempts++,this.disconnectedRecently()?n.log("ConnectionMonitor skipping reopening recent disconnect"):(n.log("ConnectionMonitor reopening"),this.connection.reopen()))},e.prototype.connectionIsStale=function(){return a(this.pingedAt?this.pingedAt:this.startedAt)>this.constructor.staleThreshold},e.prototype.disconnectedRecently=function(){return this.disconnectedAt&&a(this.disconnectedAt)<this.constructor.staleThreshold},e.prototype.visibilityDidChange=function(){var e=this;"visible"===document.visibilityState&&setTimeout((function(){!e.connectionIsStale()&&e.connection.isOpen()||(n.log("ConnectionMonitor reopening stale connection on visibilitychange. visibilityState = "+document.visibilityState),e.connection.reopen())}),200)},e}();l.pollInterval={min:3,max:30,multiplier:5},l.staleThreshold=6;var u={message_types:{welcome:"welcome",disconnect:"disconnect",ping:"ping",confirmation:"confirm_subscription",rejection:"reject_subscription"},disconnect_reasons:{unauthorized:"unauthorized",invalid_request:"invalid_request",server_restart:"server_restart"},default_mount_path:"/cable",protocols:["actioncable-v1-json","actioncable-unsupported"]},d=u.message_types,p=u.protocols,f=p.slice(0,p.length-1),h=[].indexOf,m=function(){function e(t){o(this,e),this.open=this.open.bind(this),this.consumer=t,this.subscriptions=this.consumer.subscriptions,this.monitor=new l(this),this.disconnected=!0}return e.prototype.send=function(e){return!!this.isOpen()&&(this.webSocket.send(JSON.stringify(e)),!0)},e.prototype.open=function(){return this.isActive()?(n.log("Attempted to open WebSocket, but existing socket is "+this.getState()),!1):(n.log("Opening WebSocket, current state is "+this.getState()+", subprotocols: "+p),this.webSocket&&this.uninstallEventHandlers(),this.webSocket=new t.WebSocket(this.consumer.url,p),this.installEventHandlers(),this.monitor.start(),!0)},e.prototype.close=function(){if((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{allowReconnect:!0}).allowReconnect||this.monitor.stop(),this.isActive())return this.webSocket.close()},e.prototype.reopen=function(){if(n.log("Reopening WebSocket, current state is "+this.getState()),!this.isActive())return this.open();try{return this.close()}catch(e){n.log("Failed to reopen WebSocket",e)}finally{n.log("Reopening WebSocket in "+this.constructor.reopenDelay+"ms"),setTimeout(this.open,this.constructor.reopenDelay)}},e.prototype.getProtocol=function(){if(this.webSocket)return this.webSocket.protocol},e.prototype.isOpen=function(){return this.isState("open")},e.prototype.isActive=function(){return this.isState("open","connecting")},e.prototype.isProtocolSupported=function(){return h.call(f,this.getProtocol())>=0},e.prototype.isState=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return h.call(t,this.getState())>=0},e.prototype.getState=function(){if(this.webSocket)for(var e in t.WebSocket)if(t.WebSocket[e]===this.webSocket.readyState)return e.toLowerCase();return null},e.prototype.installEventHandlers=function(){for(var e in this.events){var t=this.events[e].bind(this);this.webSocket["on"+e]=t}},e.prototype.uninstallEventHandlers=function(){for(var e in this.events)this.webSocket["on"+e]=function(){}},e}();m.reopenDelay=500,m.prototype.events={message:function(e){if(this.isProtocolSupported()){var t=JSON.parse(e.data),r=t.identifier,o=t.message,i=t.reason,s=t.reconnect;switch(t.type){case d.welcome:return this.monitor.recordConnect(),this.subscriptions.reload();case d.disconnect:return n.log("Disconnecting. Reason: "+i),this.close({allowReconnect:s});case d.ping:return this.monitor.recordPing();case d.confirmation:return this.subscriptions.notify(r,"connected");case d.rejection:return this.subscriptions.reject(r);default:return this.subscriptions.notify(r,"received",o)}}},open:function(){if(n.log("WebSocket onopen event, using '"+this.getProtocol()+"' subprotocol"),this.disconnected=!1,!this.isProtocolSupported())return n.log("Protocol is unsupported. Stopping monitor and disconnecting."),this.close({allowReconnect:!1})},close:function(e){if(n.log("WebSocket onclose event"),!this.disconnected)return this.disconnected=!0,this.monitor.recordDisconnect(),this.subscriptions.notifyAll("disconnected",{willAttemptReconnect:this.monitor.isRunning()})},error:function(){n.log("WebSocket onerror event")}};var g=function(e,t){if(null!=t)for(var n in t){var r=t[n];e[n]=r}return e},b=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2];o(this,e),this.consumer=t,this.identifier=JSON.stringify(n),g(this,r)}return e.prototype.perform=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.action=e,this.send(t)},e.prototype.send=function(e){return this.consumer.send({command:"message",identifier:this.identifier,data:JSON.stringify(e)})},e.prototype.unsubscribe=function(){return this.consumer.subscriptions.remove(this)},e}(),y=function(){function e(t){o(this,e),this.consumer=t,this.subscriptions=[]}return e.prototype.create=function(e,t){var n=e,o="object"===(void 0===n?"undefined":r(n))?n:{channel:n},i=new b(this.consumer,o,t);return this.add(i)},e.prototype.add=function(e){return this.subscriptions.push(e),this.consumer.ensureActiveConnection(),this.notify(e,"initialized"),this.sendCommand(e,"subscribe"),e},e.prototype.remove=function(e){return this.forget(e),this.findAll(e.identifier).length||this.sendCommand(e,"unsubscribe"),e},e.prototype.reject=function(e){var t=this;return this.findAll(e).map((function(e){return t.forget(e),t.notify(e,"rejected"),e}))},e.prototype.forget=function(e){return this.subscriptions=this.subscriptions.filter((function(t){return t!==e})),e},e.prototype.findAll=function(e){return this.subscriptions.filter((function(t){return t.identifier===e}))},e.prototype.reload=function(){var e=this;return this.subscriptions.map((function(t){return e.sendCommand(t,"subscribe")}))},e.prototype.notifyAll=function(e){for(var t=this,n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return this.subscriptions.map((function(n){return t.notify.apply(t,[n,e].concat(r))}))},e.prototype.notify=function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return("string"==typeof e?this.findAll(e):[e]).map((function(e){return"function"==typeof e[t]?e[t].apply(e,r):void 0}))},e.prototype.sendCommand=function(e,t){var n=e.identifier;return this.consumer.send({command:t,identifier:n})},e}(),v=function(){function e(t){o(this,e),this._url=t,this.subscriptions=new y(this),this.connection=new m(this)}return e.prototype.send=function(e){return this.connection.send(e)},e.prototype.connect=function(){return this.connection.open()},e.prototype.disconnect=function(){return this.connection.close({allowReconnect:!1})},e.prototype.ensureActiveConnection=function(){if(!this.connection.isActive())return this.connection.open()},i(e,[{key:"url",get:function(){return w(this._url)}}]),e}();function w(e){if("function"==typeof e&&(e=e()),e&&!/^wss?:/i.test(e)){var t=document.createElement("a");return t.href=e,t.href=t.href,t.protocol=t.protocol.replace("http","ws"),t.href}return e}function x(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A("url")||u.default_mount_path;return new v(e)}function A(e){var t=document.head.querySelector("meta[name='action-cable-"+e+"']");if(t)return t.getAttribute("content")}e.Connection=m,e.ConnectionMonitor=l,e.Consumer=v,e.INTERNAL=u,e.Subscription=b,e.Subscriptions=y,e.adapters=t,e.createWebSocketURL=w,e.logger=n,e.createConsumer=x,e.getConfig=A,Object.defineProperty(e,"__esModule",{value:!0})}(Ft.exports);const zt=()=>{Ut=!0,document.body.classList.replace("stimulus-reflex-disconnected","stimulus-reflex-connected"),ge("stimulus-reflex:connected"),ge("stimulus-reflex:action-cable:connected")},qt=()=>{Ut=!1,document.body.classList.replace("stimulus-reflex-connected","stimulus-reflex-disconnected"),ge("stimulus-reflex:rejected"),ge("stimulus-reflex:action-cable:rejected"),Debug.enabled&&console.warn("Channel subscription was rejected.")},Kt=e=>{Ut=!1,document.body.classList.replace("stimulus-reflex-connected","stimulus-reflex-disconnected"),ge("stimulus-reflex:disconnected",e),ge("stimulus-reflex:action-cable:disconnected",e)};var Ht={consumer:$t,params:Vt,get subscriptionActive(){return Ut},createSubscription:e=>{$t=$t||e.application.consumer||Ft.exports.createConsumer();const{channel:t}=e.StimulusReflex,n=a({channel:t},Vt),r=JSON.stringify(n);e.StimulusReflex.subscription=$t.subscriptions.findAll(r)[0]||$t.subscriptions.create(n,{received:St,connected:zt,rejected:qt,disconnected:Kt})},connected:zt,rejected:qt,disconnected:Kt,set(e,t){$t=e,Vt=t}};class Wt extends fe{constructor(...e){super(...e),Qt(this)}}const Qt=(e,t={})=>{e.StimulusReflex=c(a({},t),{channel:"StimulusReflex::Channel"}),Ht.createSubscription(e),Object.assign(e,{isActionCableConnectionOpen(){return this.StimulusReflex.subscription.consumer.connection.isOpen()},stimulate(){const e=location.href,t=Array.from(arguments),n=t.shift()||"StimulusReflex::Reflex#default_reflex",r=this.element,o=t[0]&&t[0].nodeType===Node.ELEMENT_NODE?t.shift():r;if("number"===o.type&&o.validity&&o.validity.badInput)return void(xe.enabled&&console.warn("Reflex aborted: invalid numeric input"));const i={};if(t[0]&&"object"==typeof t[0]&&Object.keys(t[0]).filter((e=>["attrs","selectors","reflexId","resolveLate","serializeForm","suppressLogging","includeInnerHTML","includeTextContent"].includes(e))).length){const e=t.shift();Object.keys(e).forEach((t=>i[t]=e[t]))}const s=new Bt(i,o,r,this.identifier,ft.reflexPermanent,n,t,e,Xt),l=s.reflexId;if(!this.isActionCableConnectionOpen())throw"The ActionCable connection is not open! `this.isActionCableConnectionOpen()` must return true before calling `this.stimulate()`";if(!Ht.subscriptionActive)throw"The ActionCable channel subscription for StimulusReflex was rejected.";r.reflexController=r.reflexController||{},r.reflexData=r.reflexData||{},r.reflexError=r.reflexError||{},r.reflexController[l]=this,r.reflexData[l]=s.valueOf(),jt("before",o,r,l),setTimeout((()=>{const{params:e}=r.reflexData[l]||{},t=o.attributes[ft.reflexSerializeForm];t&&(i.serializeForm="false"!==t.value);const n=o.closest(s.formSelector)||document.querySelector(s.formSelector)||o.closest("form");bt.enabled&&void 0===i.serializeForm&&n&&console.warn(`Deprecation warning: the next version of StimulusReflex will not serialize forms by default.\nPlease set ${ft.reflexSerializeForm}="true" on your Reflex Controller Element or pass { serializeForm: true } as an option to stimulate.`);const u=!1===i.serializeForm?"":((e,t={})=>{if(!e)return"";const n=t.w||window,{element:r}=t,o=new n.FormData(e),i=Array.from(o,(e=>e.map(encodeURIComponent).join("="))),s=e.querySelector("input[type=submit]");return r&&r.name&&"INPUT"===r.nodeName&&"submit"===r.type?i.push(`${encodeURIComponent(r.name)}=${encodeURIComponent(r.value)}`):s&&s.name&&i.push(`${encodeURIComponent(s.name)}=${encodeURIComponent(s.value)}`),Array.from(i).join("&")})(n,{element:o});r.reflexData[l]=c(a({},s.valueOf()),{params:e,formData:u}),this.StimulusReflex.subscription.send(r.reflexData[l])}));const u=Ct(s.valueOf());return Nt(l,n,t,this.context.scope.identifier,o,r),u},__perform(e){let t,n=e.target;for(;n&&!t;)t=n.getAttribute(ft.reflex),t&&t.trim().length||(n=n.parentElement);const r=vt(t).find((t=>t.split("->")[0]===e.type));r&&(e.preventDefault(),e.stopPropagation(),this.stimulate(r.split("->")[1],n))}})},Xt=he();document.addEventListener("cable-ready:after-dispatch-event",(e=>{const{stimulusReflex:t,payload:n,name:r,body:o}=e.detail||{},i=r.split("-")[2];if(!t||!["nothing","halted","error"].includes(i))return;const{reflexId:s,xpathElement:a,xpathController:c}=t,l=ye(a),u=ye(c),d=Ot[s],{promise:p}=d;switch(u&&(u.reflexError=u.reflexError||{},"error"===i&&(u.reflexError[s]=o)),i){case"nothing":Rt(e,n,p,d,l);break;case"error":Dt(e,n,p,d,l);break;case"halted":Lt(e,n,p,d,l)}setTimeout((()=>jt(i,l,u,s,n))),d.piggybackOperations.length&&ut.perform(d.piggybackOperations)})),document.addEventListener("cable-ready:before-inner-html",Mt),document.addEventListener("cable-ready:before-morph",Mt),document.addEventListener("cable-ready:after-inner-html",It),document.addEventListener("cable-ready:after-morph",It),window.addEventListener("load",Tt);var Jt={initialize:(e,{controller:t,consumer:n,debug:r,params:o,isolate:i,deprecate:s}={})=>{Ht.set(n,o),document.addEventListener("DOMContentLoaded",(()=>{document.body.classList.remove("stimulus-reflex-connected"),document.body.classList.add("stimulus-reflex-disconnected"),bt.enabled&&n&&console.warn("Deprecation warning: the next version of StimulusReflex will obtain a reference to consumer via the Stimulus application object.\nPlease add 'application.consumer = consumer' to your index.js after your Stimulus application has been established, and remove the consumer key from your StimulusReflex initialize() options object."),bt.enabled&&mt.disabled&&console.warn("Deprecation warning: the next version of StimulusReflex will standardize isolation mode, and the isolate option will be removed.\nPlease update your applications to assume that every tab will be isolated.")}),{once:!0}),mt.set(!!i),Ot.app=e,ft.set(e),Ot.app.register("stimulus-reflex",t||Wt),xe.set(!!r),void 0!==s&&bt.set(s);new MutationObserver(Tt).observe(document.documentElement,{attributeFilter:[ft.reflex,ft.action],childList:!0,subtree:!0})},register:Qt,useReflex:(e,t={})=>{Qt(e,t)},get debug(){return xe.value},set debug(e){xe.set(!!e)},get deprecate(){return bt.value},set deprecate(e){bt.set(!!e)}};class Yt extends fe{connect(){Jt.register(this)}beforeReflex(){document.body.classList.add("wait")}afterReflex(){document.body.classList.remove("wait")}reflexHalted(){document.body.classList.remove("wait")}stimulateRosh(e,t,n){this.stimulate(e,t,n)}}var Gt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Yt});var Zt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:class extends Yt{beforeReflex(){const e=document.getElementsByClassName("fade-in");for(const t of e)t.classList.remove("fade-in")}}});const en=/^\d{2}$/,tn=/^\d{2}\/\d{2}$/,nn=/^\d{3}$/,rn=/^\d{2}\/\d{3}$/;var on=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:class extends Yt{slashifyDate(e){const t=e.target,n=e.target.value;"deleteContentBackward"===e.inputType?((e,t)=>{t.endsWith("/")&&(e.value=t.slice(0,-1))})(t,n):((e,t)=>{(en.test(t)||tn.test(t))&&(e.value=t+"/"),nn.test(t)&&(e.value=t.slice(0,2)+"/"+t.slice(-1)),rn.test(t)&&(e.value=t.slice(0,5)+"/"+t.slice(-1))})(t,n)}}});var sn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:class extends fe{resetAssignments(e){const t="Resetting assignments will remove the assessment\n      from the learner's account, your program director dashboard, and all group\n      reports. If you need a copy of assessment performance, please download the\n      Cohort Asessment Report before proceeding. The assessments will become\n      available to assign again. This action cannot be undone. Would you like to\n      continue?\n    ".replace(/\s+/g," "),n=confirm(t),r=e.target.dataset.jwt;if(n){const e=document.getElementsByName("exam_ids[]"),t={examIds:Array.from(e).filter((e=>e.checked)).map((e=>e.value))};fetch("/api/v3/assignment_resets",{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify(t)}).then((()=>location.reload()))}}}});var an=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:class extends Yt{afterChangeQbank(e){window.location.reload()}}});const cn=e=>console.log(e);class ln extends fe{updateCurrentQbank(){const e=this.subscriberFormTarget,t=new FormData(e),n=new URLSearchParams(t),r={method:e.method,body:n};fetch(e.action,r).then((e=>((e=>{e.style.display="inline"})(this.spinnerTarget),void location.reload()))).catch(cn)}}ln.targets=["subscriberForm","spinner"];var un=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:ln});var dn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:class extends Yt{}});var pn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:class extends Yt{sort(){const e=document.getElementById("question-list"),t=Array.from(document.getElementsByClassName("question-card")).map(((e,t)=>({id:e.dataset.questionId,position:t+1}))),n={sequenceId:e.dataset.sequenceId,questions:t};this.stimulateRosh("Sequence#sort",e,n)}create(e){e.preventDefault();const t=document.getElementById("quick-create"),n={name:t.value};this.stimulateRosh("Sequence#create",t,n)}addQuestions(e){e.preventDefault();const t=document.getElementById("quick-addQID"),n={qids:t.value};this.stimulateRosh("Sequence#add_question",t,n)}}});var fn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:class extends Yt{afterReflex(){this.element.closest("form").submit()}}});var hn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:class extends fe{toggleRadioButton(e){e.preventDefault();const t=e.currentTarget;if(!(t instanceof HTMLElement))return;const n=t.dataset.for;t.parentElement.querySelector(`#${n}`).checked=!0}}}),mn=/^(?:.*?(?:controllers|components)\/|\.?\.\/)?(.+)(?:[_-]controller\..+?)$/;function gn([e,t]){const n=function(e){const t=(e.match(mn)||[])[1];if(t)return t.replace(/_/g,"-").replace(/\//g,"--")}(e),r=t.default;if(n&&"function"==typeof r)return{identifier:n,controllerConstructor:r}}var bn=Ft.exports.createConsumer();var yn={DOMContentLoaded:{wait:200},abort:{wait:200},animationcancel:{wait:200},animationend:{wait:200},animationiteration:{wait:200},animationstart:{wait:200},auxclick:{wait:200},change:{wait:200},click:{wait:200},compositionend:{wait:200},compositionstart:{wait:200},compositionupdate:{wait:200},contextmenu:{wait:200},copy:{wait:200},cut:{wait:200},dblclick:{wait:200},drag:{wait:200},dragend:{wait:200},dragenter:{wait:200},dragleave:{wait:200},dragover:{wait:200},dragstart:{wait:200},drop:{wait:200},error:{wait:200},focusin:{wait:200},focusout:{wait:200},fullscreenchange:{wait:200},fullscreenerror:{wait:200},hashchange:{wait:200},input:{wait:200},keydown:{wait:200},keyup:{wait:200},mousedown:{wait:200},mousemove:{wait:200},mouseout:{wait:200},mouseover:{wait:200},mouseup:{wait:200},paste:{wait:200},pointercancel:{wait:200},pointerdown:{wait:200},pointerlockchange:{wait:200},pointerlockerror:{wait:200},pointermove:{wait:200},pointerout:{wait:200},pointerover:{wait:200},pointerup:{wait:200},popstate:{wait:200},reset:{wait:200},scroll:{wait:200},select:{wait:200},submit:{wait:200},touchcancel:{wait:200},touchend:{wait:200},touchmove:{wait:200},touchstart:{wait:200},transitioncancel:{wait:200},transitionend:{wait:200},transitionrun:{wait:200},transitionstart:{wait:200},visibilitychange:{wait:200},wheel:{wait:200}};let vn="debounced";const wn={},xn=(e,t={})=>{const{wait:n}=t;let r;return(...t)=>{clearTimeout(r),r=setTimeout((()=>{r=null,e(...t)}),n)}},An=e=>{const{bubbles:t,cancelable:n,composed:r}=e,o=new CustomEvent(`${vn}:${e.type}`,{bubbles:t,cancelable:n,composed:r,detail:{originalEvent:e}});setTimeout(e.target.dispatchEvent(o))},En=(e,t={})=>{if(wn[e])return;wn[e]=t||{};const n=xn(An,t);document.addEventListener(e,(e=>n(e)))};var On=(e=yn)=>{vn=e.prefix||vn,delete e.prefix;for(const[t,n]of Object.entries(e))En(t,n)};On({input:{wait:250}});const Sn=oe.start();var Cn;Cn={"./application_controller.ts":Gt,"./data_table_controller.ts":Zt,"./date_input_controller.ts":on,"./pd_assignment_controller.ts":sn,"./program_director_controller.ts":an,"./qbank_controller.ts":un,"./questions_controller.ts":dn,"./sequences_controller.ts":pn,"./submit_button_component_controller.ts":fn,"./trial_subscriptions_controller.ts":hn},Sn.load(function(e){return Object.entries(e).map(gn).filter((e=>e))}(Cn)),Jt.initialize(Sn),Jt.debug=!1,Sn.consumer=bn;export{bn as c,Ye as m};
//# sourceMappingURL=index.b50beef2.js.map
